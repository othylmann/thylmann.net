---
import QuoteBox from "./QuoteBox.astro";
import { getRandomQuote } from "../utils/quotes";
import { getLatestEpisode } from "../utils/podcast";

const { text, author } = getRandomQuote();
const latestEpisode = await getLatestEpisode();
---

<section
  class="min-h-[70vh] flex flex-col justify-center animate-fade-in py-20"
>
  <div
    class="flex flex-col md:flex-row md:items-start md:justify-between gap-12"
  >
    <div>
      <h1 class="text-6xl md:text-8xl font-bold leading-[0.9] tracking-tight">
        Oliver <br />
        Thylmann<span class="text-accent">.</span>
      </h1>

      <div class="mt-8 space-y-4 max-w-2xl">
        <p class="text-xl md:text-2xl text-text-muted">
          Serial Entrepreneur. Developer Whisperer. <br />
          Building <span class="text-text-main">meaningful systems</span> since 1999.
        </p>

        {
          latestEpisode && (
            <div class="py-4">
              <div class="p-4 rounded-2xl bg-accent/5 border border-accent/10 backdrop-blur-sm">
                <div class="flex items-center gap-3 mb-3">
                  <span class="text-xl">üéôÔ∏è</span>
                  <div>
                    <p class="text-xs font-mono text-accent uppercase tracking-wider">
                      Latest Podcast
                    </p>
                    <a
                      href={latestEpisode.link}
                      target="_blank"
                      rel="noopener noreferrer"
                      class="text-sm font-bold text-text-main hover:text-accent transition-colors line-clamp-1"
                    >
                      {latestEpisode.title}
                    </a>
                  </div>
                </div>
                <audio
                  controls
                  class="w-full h-8 opacity-80 hover:opacity-100 transition-opacity"
                >
                  <source src={latestEpisode.audioUrl} type="audio/mpeg" />
                  Your browser does not support the audio element.
                </audio>
              </div>
            </div>
          )
        }
        <div class="flex flex-wrap gap-4 pt-4">
          <a
            href="https://giantswarm.io"
            class="px-6 py-3 border border-accent/20 rounded-full text-accent hover:bg-accent/10 transition-colors"
          >
            Current: Giant Swarm
          </a>
          <a
            href="#ventures"
            class="px-6 py-3 text-text-muted hover:text-text-main transition-colors"
          >
            View Journey &darr;
          </a>
        </div>
      </div>
    </div>

    <div class="md:mt-4 self-start">
      <QuoteBox text={text} author={author} />
    </div>
  </div>
</section>

<style>
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  .animate-fade-in {
    animation: fadeIn 0.8s ease-out forwards;
  }
</style>
